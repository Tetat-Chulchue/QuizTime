<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Information</title>
    <link href="https://fonts.googleapis.com/css?family=Kanit:300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/Game1/scoreBoard.css">
    <link rel="stylesheet" href="../CSS/Game1/bg-animation.css">
    <link rel="stylesheet" href="../CSS/main_page/loading.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="../../CSS/Game1/bg-animation.css">
    <link rel="stylesheet" href="../CSS/template.css">
    <link rel="stylesheet" href="../CSS/Game3/colorThem.css">
    <script src="../JS/Game1/loading.js"></script>

    <link rel="icon" href="../assets/logo2.png" type="image/png" sizes="200x200">
</head>
<body>
    
    <!-- ------------------------ Page loader zone ------------------------ -->
    <div class="loadder" id="loadder">
        <div class="loading-box">
            <img src="../assets/loader.gif" alt="" class="loader-img">
        </div>
    </div>
    <!-- ------------------------ Page loader zone ------------------------ -->

    <!-- ------------------------ Input and label zone ------------------------ -->
    <input type="checkbox" name="chk1" id="chk1"> <!-- input for navi bar-->
    <label for="chk1" class="bar-label"></label> <!-- input for navi bar-->

    <input type="checkbox" name="chk2" id="chk2"> <!-- input for navi bar-->
    <label for="chk2" class="bar-label2"><p>Hyper link</p></label> <!-- input for navi bar-->
    <!-- ------------------------ Input and label zone ------------------------ -->

    <!-- ------------------------ Background ainmation zone ------------------------ -->
    <div class="bg-animation" id="test">
        <span class="bg-circle" id="CC-1"></span>
        <span class="bg-circle" id="CC-3"></span>
        <span class="bg-circle" id="CC-4"></span>

        <span class="bg-circle" id="CC-2"></span>
        <span class="bg-circle" id="CC-6"></span>
        <span class="bg-circle" id="CC-7"></span>
        <span class="bg-circle" id="CC-8"></span>
    </div>
    <!-- ------------------------ Background ainmation zone ------------------------ -->

    <div class="case">

        <!-- ------------------------ Navigation zone ------------------------ -->
        <div class="navigation-box">
            <span class="span-bar"></span>
            <span class="span-bar"></span>
            <span class="span-bar"></span>
        </div>
        <div class="navigation-bar" id="navigation-bar">
            <div class="title-text">
                <h1>SpeedTyping</h1>
            </div>
            <div class="navi-link-page">
                <a href="../index.html">Main page</a>
                <a href="../Game1/howTo.html">How to play</a>
                <a href="../Game1/gameManu.html">Play game</a>
                <!-- <a href="../Game1/scoreBoard.html">Score board</a> -->
                <a href="#1">Vocabulary</a>
            </div>
        </div>
        <!-- ------------------------ Navigation zone ------------------------ -->

        <!-- ------------------------ Box left zone ------------------------ -->
        <div class="box-left">
            <div class="box-left-container">
                <div class="logo">
                    <a href="../index.html">
                        <img src="../assets/logo2.png" alt="">
                    </a>
                </div>
                <div class="hardder-text">
                    <h1>SpeedTyping</h1>
                </div>
                <div class="static-box">
                    <div class="link-page"><a href="../index.html" >หน้าหลัก</a></div>
                    <div class="link-page"><a href="../Game3/information.html">เนื้อหาหลัก</a></div>
                    <!-- <div class="link-page"><a href="../Game1/information.html#1" >Vocabulary</a></div> -->
                    <div class="link-page"><a href="../Game3/howTo.html" >วิธีเล่น</a></div>
                    <div class="link-page"><a href="../Game3/gameManu.html" >เล่นเกม</a></div>
                </div>
                <div class="left-footer">
                    <p>Copyright © 2019 IT KMITL</p>
                </div>
            </div>
        </div>
        <!-- ------------------------ Box left zone ------------------------ -->

        <div class="box-right" style="display: block;">
            <!-- ------------------------ conten zone ------------------------ -->
            <div class="center-haeder-text">
                <h2>Score board</h2>
            </div>
            <div class="center-conten-table">
                <div class="conten-filter-container">
                    <div class="filter-box" onclick="preloader()">
                        <p>Refresh</p>
                    </div>
                    <div class="filter-loader">
                        <img src="../assets/loader.gif" alt="" id="fliterImgLoader">
                        <p id="res-error"></p>
                    </div>
                    <!-- <select id="setNumber" name="setNumber" class="filter-box" style="right: 0; padding-left: 10px;" onchange="preloader()">
                        <option value="set_1">ชุดที่ 1</option>
                        <option value="set_2">ชุดที่ 2</option>
                        <option value="set_3">ชุดที่ 3</option>
                        <option value="set_4">ชุดที่ 4</option>
                        <option value="set_5">ชุดที่ 5</option>
                        <option value="set_6">ชุดที่ 6</option>
                        <option value="set_7">ชุดที่ 7</option>
                        <option value="set_8">ชุดที่ 8</option>
                        <option value="set_9">ชุดที่ 9</option>
                        <option value="set_10">ชุดที่ 10</option>
                    </select> -->
                </div>
                <table id="mytable" >
                    <thead>
                        <tr>
                            <th>No.</th>
                            <th>ชื่อ</th>
                            <th>Word per minute</th>
                            <th>Accuracy</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
            <!-- ------------------------ conten zone ------------------------ -->
        </div>
    </div>

    <!-- ------------------------ Hyper link zone ------------------------ -->
    <div class="box-right2">
        <div class="right2-container">
            <!-- <div class="right2-header-text">
                <h2>Other game.</h2>
            </div> -->
            <div class="right2-box-container" id="right-animation">
                <a href="../Game1/information.html">
                    <div class="rigth2-box" style="background-image: url('../assets/gif_1/information.gif');"><h3>SpellingBee</h3></div>
                </a>
                <a href="../Game2/information.html">
                    <div class="rigth2-box" style="background-image: url('../assets/gif_2/1.gif');"><h3>2s2is4</h3></div>
                </a>
            </div>
        </div>
    </div>
    <!-- ------------------------ Hyper link zone ------------------------ -->

    <script>
        let keys = {};
        let datas = {};
        let counter = 1;
        let error_text = document.getElementById("res-error");
        let table = document.getElementById("mytable");
        let tbody = document.createElement('tbody');

        function preloader() {
            // setNumber = document.getElementById('setNumber').value;
            document.getElementById("fliterImgLoader").style.visibility = "unset";
            error_text.innerHTML = "";
            axios({
                method: "GET",
                url: "https://us-central1-itec-websession.cloudfunctions.net/speedTyping/scoreboard"
            })
            .then(data => {
                keys = Object.keys(data.data);
                datas = data.data;
                console.log(keys, datas);
                render()

            })
            .catch(err => {
                console.log(err);
                error_text.innerHTML = err;
            });
        }

        function render() {
            if (table.rows.length > 1 && keys != {} && table.rows.length != 2 ) {
                refresh()
                function refresh() {
                    table.deleteRow(1);
                    if (table.rows.length >= 2 && refresh() != false) {
                        refresh()
                    } else {
                        return false;
                    }
                }
                counter = 1;
            } else if (table.rows.length == 2 && keys != {}) {
                table.deleteRow(-1);
                counter = 1;
            } else if (keys == {}) {
                error_text.innerHTML = "Not found!!";
            }
            for (const i in keys) {
                let row = tbody.insertRow(-1);
                let cell0 = row.insertCell(0);
                let cell1 = row.insertCell(1);
                let cell2 = row.insertCell(2);
                let cell3 = row.insertCell();
                cell0.innerHTML = `<p>${counter++}</p>`;
                cell1.innerHTML = `<p>${keys[i]}</p>`;
                cell2.innerHTML = `<p>${datas[keys[i]].wpm}</p>`;
                cell3.innerHTML = `<p>${datas[keys[i]].accuracy}</p>`;
                table.append(tbody);
            }
            document.getElementById("fliterImgLoader").style.visibility = "hidden";
        }

        window.onload = async () => {
            // await preloader();
        }
    </script>
</body>
</html>